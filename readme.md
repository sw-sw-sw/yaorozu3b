# yaorozu3 作業メモ
# 2024-08-23

クラスベースの設計からプロセス関数を直接定義する方式に変更。
＝＞これにより、クラスのインスタンス化に関連する問題を回避できます。


各プロセス関数（tf_loop、box2d_loop、render_loop）を独立した関数として定義し、必要な引数を明示的に渡すようにした。


共有メモリとプロセス間通信に使用するオブジェクト（shared_positions、shared_forces、rendering_queue、running）をメイン関数内で作成し、各プロセスに引数として渡すようにした。


初期化処理をシンプルにし、プロセス間で共有できない複雑なオブジェクトの使用を避けました。


KeyboardInterruptを適切に処理し、プロセスを安全に終了できるようにしました。

---------------------------------------

tensorflowとrenderとbox2dはそれぞれパラレルに動作=>成功
tensorflowとbox2dの周期の差は、エージェントの運動の振動につながる。
周囲差分を、time.sleep()で調整した。

---
# 他の高速化

float16にするのは失敗
バッチ化は意味なし

# 2024-08-23
tensorflowとbox2dの周期を合わせると処理速度が上がった。

- **キャッシュの効率的利用:** 同期により、CPUのキャッシュがより効率的に利用されるようになった可能性があります。
- **リソースの競合減少:** プロセス間でのCPUやメモリリソースの競合が減少し、各プロセスがより効率的に動作できるようになった可能性があります。
- **メモリアクセスの最適化:** プロセス間で交互にメモリにアクセスすることで、メモリバスの利用効率が向上した可能性があります。
- **コンテキストスイッチの最適化:** プロセス間のコンテキストスイッチがより規則的かつ効率的になった可能性があります。
- **タイミングの最適化:** 各プロセスが最適なタイミングでデータを処理できるようになった可能性があります。